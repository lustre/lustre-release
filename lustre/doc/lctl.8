.TH lctl 1 "2003 Oct 8" Lustre "configuration utilities"
.SH NAME
lctl \- Low level Lustre filesystem configuration utility
.SH SYNOPSIS
.br
.B lctl
.br
.B lctl --device <devno> <command [args]>
.br
.SH DESCRIPTION
.B lctl
is used to directly control Lustre via an ioctl interface, allowing
various configuration, maintenance, and debugging features to be accessed.
 
.B lctl
can be invoked in interactive mode by issuing lctl command. After that, commands are issued as below. The most common commands in lctl are
.B dl
,
.B dk
,
.B device 
,
.B network 
.I <up/down>
,
.B list_nids
,
.B ping
.I nid
,
.B help
,
.B quit.

To get a complete listing of available commands, type
.B help
at the lctl prompt.  To get basic help on the meaning and syntax of a
command, type 
.B help 
.I command
.  Command completion is activated with the TAB key, and command history is available via the up- and down-arrow keys. 

For non-interactive use, one uses the second invocation, which runs command after connecting to the device. 

.SS Network Configuration
.TP
.BI network " <up/down>|<tcp/elan/myrinet>"
Start or stop LNET, or select a network type for other
.I lctl
LNET commands
.TP
.BI list_nids
Print all Network Identifiers on the local node. LNET must be running.
.TP
.BI which_nid " <nidlist>"
From a list of nids for a remote node, show which interface communication
will take place on.
.TP
.BI ping " <nid> "
Check LNET connectivity via an LNET ping. This will use the fabric
appropriate to the specified NID.
.TP
.BI interface_list 
Print the network interface information for a given 
.B network
type.
.TP
.BI peer_list 
Print the known peers for a given 
.B network
type.
.TP
.BI conn_list 
Print all the connected remote NIDs for a given
.B network
type.
.TP
.BI active_tx 
This command should print active transmits, and it is only used for elan network type.
.TP 
.BI route_list 
Print the complete routing table.
.PP
.SS Device Selection
.TP 
.BI device " <devname> " 
This will select the specified OBD device.  All other commands depend on the device being set. 
.TP 
.BI device_list 
Show all the local Lustre OBDs. AKA 
.B dl
.PP
.SS Device Operations
.TP 
.BI conf_param " <device> <parameter>"
Set a permanent configuration parameter for any device via the MGS.  This
command must be run on the MGS node. 
.TP 
.BI activate 
Reactivate an import after deactivating, below.
.TP 
.BI deactivate 
Deactivate an import, in particular meaning do not assign new file stripes
to an OSC.  This command should be used on the OSC in the MDT LOV
corresponding to a failed OST device, to prevent further attempts at
communication with the failed OST.
.TP 
.BI abort_recovery 
Abort the recovery process on a restarting MDT or OST device
.PP
.SS Virtual Block Device Operation
Lustre is able to emulate a virtual block device upon regular file. It is necessary to be used when you are trying to setup a swap space via file.
.TP
.BI blockdev_attach " <file name> <device node>"
Attach the lustre regular file to a block device. If the device node is not existent, lctl will create it \- it is recommended to create it by lctl since the emulator uses a dynamical major number.
.TP
.BI blockdev_detach " <device node>"
Detach the virtual block device.
.TP
.BI blockdev_info " <device node>"
Acquire which lustre file was attached to the device node.
.PP
.SS Debug
.TP 
.BI debug_daemon 
Start and stop the debug daemon, and control the output filename and size.
.TP 
.BI debug_kernel " [file] [raw]" 
Dump the kernel debug buffer to stdout or file.
.TP 
.BI debug_file " <input> [output]"
Convert kernel-dumped debug log from binary to plain text format.
.TP 
.BI clear 
Clear the kernel debug buffer.
.TP 
.BI mark " <text>" 
Insert marker text in the kernel debug buffer.
.TP 
.BI filter " <subsystem id/debug mask>" 
Filter kernel debug messages by subsystem or mask.
.TP 
.BI show " <subsystem id/debug mask>" 
Show specific type of messages.
.TP 
.BI debug_list " <subs/types>" 
List all the subsystem and debug types.
.TP
.BI modules " <path>" 
Provide gdb-friendly module information.

.SH OPTIONS
The following options can be used to invoke lctl. 
.TP
.B --device 
The device to be used for the operation. This can be specified by name or
number. See 
.B device_list
.TP
.B --ignore_errors | ignore_errors 
Ignore errors during script processing
.TP
.SH EXAMPLES
# lctl
.br
lctl > dl
  0 UP mgc MGC192.168.0.20@tcp bfbb24e3-7deb-2ffa-eab0-44dffe00f692 5
  1 UP ost OSS OSS_uuid 3
  2 UP obdfilter testfs-OST0000 testfs-OST0000_UUID 3
.br
lctl > dk /tmp/log
Debug log: 87 lines, 87 kept, 0 dropped.
.br
lctl > quit
.PP
# lctl conf_param testfs-MDT0000 sys.timeout=40

.SH BUGS
Please report all bugs to ClusterFileSystems, support@clusterfs.com
.SH AVAILABILITY
.B lctl
is part of the 
.BR Lustre (7) 
filesystem package and is available from CFS
.br
http://clusterfs.com
.SH SEE ALSO
.BR Lustre (7),
.BR mkfs.lustre (8),
.BR mount.lustre (8),
.BR lctl (8),
.BR lfs (1)
