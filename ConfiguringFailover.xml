<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xml:lang="en-US" xmlns="http://docbook.org/ns/docbook" xmlns:xl="http://www.w3.org/1999/xlink" xml:id='configuringfailover'>
  <info>
    <title>Configuring Lustre Failover</title>
  </info>
  <para><anchor xml:id="dbdoclet.50438188_pgfId-1292189" xreflabel=""/>This chapter describes how to configure Lustre failover using the Heartbeat cluster infrastructure daemon. It includes:</para>

  <itemizedlist><listitem>
          <para><xref linkend='dbdoclet.50438188_82389'/></para>
      </listitem>
      <listitem>
          <para><xref linkend='dbdoclet.50438188_92688'/></para>
      </listitem>
  </itemizedlist>

  <note>
      <para>
          Using Lustre Failover is optional
      </para>
  </note>

    <section xml:id="dbdoclet.50438188_82389">
      <title>11.1 Creating a Failover Environment</title>
      <para><anchor xml:id="dbdoclet.50438188_pgfId-1292209" xreflabel=""/>Lustre provides failover mechanisms only at the file system level. No failover functionality is provided for system-level components, such as node failure detection or power control, as would typically be provided in a complete failover solution. Additional tools are also needed to provide resource fencing, control and monitoring.</para>
      <section remap="h3">
        <title><anchor xml:id="dbdoclet.50438188_pgfId-1292210" xreflabel=""/>11.1.1 Power Management Software</title>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292211" xreflabel=""/>Lustre failover requires power control and management capability to verify that a failed node is shut down before I/O is directed to the failover node. This avoids double-mounting the two nodes, and the risk of unrecoverable data corruption. A variety of power management tools will work, but two packages that are commonly used with Lustre are STONITH and PowerMan.</para>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292212" xreflabel=""/>Shoot The Other Node In The HEAD (STONITH), is a set of power management tools provided with the Linux-HA package. STONITH has native support for many power control devices and is extensible. It uses expect scripts to automate control.</para>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292213" xreflabel=""/>PowerMan, available from the Lawrence Livermore National Laboratory (LLNL), is used to control remote power control (RPC) devices from a central location. PowerMan provides native support for several RPC varieties and expect-like configuration simplifies the addition of new devices.</para>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292214" xreflabel=""/>The latest versions of PowerMan are available at:</para>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292216" xreflabel=""/><link xl:href="http://sourceforge.net/projects/powerman">http://sourceforge.net/projects/powerman</link></para>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292217" xreflabel=""/>For more information about PowerMan, go to:</para>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292219" xreflabel=""/><link xl:href="https://computing.llnl.gov/linux/powerman.html">https://computing.llnl.gov/linux/powerman.html</link></para>
      </section>
      <section remap="h3">
        <title><anchor xml:id="dbdoclet.50438188_pgfId-1292220" xreflabel=""/>11.1.2 Power Equipment</title>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292221" xreflabel=""/>Lustre failover also requires the use of RPC devices, which come in different configurations. Lustre server nodes may be equipped with some kind of service processor that allows remote power control. If a Lustre server node is not equipped with a service processor, then a multi-port, Ethernet-addressable RPC may be used as an alternative. For recommended products, refer to the list of supported RPC devices on the PowerMan website.</para>
        <para><anchor xml:id="dbdoclet.50438188_pgfId-1292223" xreflabel=""/><link xl:href="https://computing.llnl.gov/linux/powerman.html">https://computing.llnl.gov/linux/powerman.html</link></para>
      </section>
    </section>
    <section xml:id="dbdoclet.50438188_92688">
      <title>11.2 Setting up High-Availability (HA) Software with Lustre</title>
      <para><anchor xml:id="dbdoclet.50438188_pgfId-1292225" xreflabel=""/>Lustre must be combined with high-availability (HA) software to enable a complete Lustre failover solution. Lustre can be used with several HA packages including:</para>
      <itemizedlist><listitem>
          <para><anchor xml:id="dbdoclet.50438188_pgfId-1293083" xreflabel=""/><emphasis>Red Hat Cluster Manager</emphasis>  - For more information about setting up Lustre failover with Red Hat Cluster Manager, see the Lustre wiki topic <link xl:href="http://wiki.lustre.org/index.php/Using_Red_Hat_Cluster_Manager_with_Lustre">Using Red Hat Cluster Manager with Lustre</link>.</para>
        </listitem>
<listitem>
          <para><anchor xml:id="dbdoclet.50438188_pgfId-1293110" xreflabel=""/><emphasis>Pacemaker</emphasis>  - For more information about setting up Lustre failover with Pacemaker, see the Lustre wiki topic <link xl:href="http://wiki.lustre.org/index.php/Using_Pacemaker_with_Lustre">Using Pacemaker with Lustre</link>.<anchor xml:id="dbdoclet.50438188_61775" xreflabel=""/></para>
        </listitem>
</itemizedlist>
  </section>
</chapter>
