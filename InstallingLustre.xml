<?xml version='1.0' encoding='utf-8'?>
<chapter xmlns="http://docbook.org/ns/docbook"
xmlns:xl="http://www.w3.org/1999/xlink" version="5.0" xml:lang="en-US"
xml:id="installinglustre">
  <title xml:id="installinglustre.title">Installing the Lustre Software</title>
  <para>This chapter describes how to install the Lustre software from RPM
  packages. It includes:</para>
  <itemizedlist>
    <listitem>
      <para>
        <xref linkend="dbdoclet.50438261_99193" />
      </para>
    </listitem>
    <listitem>
      <para>
        <xref linkend="dbdoclet.50438261_41900" />
      </para>
    </listitem>
  </itemizedlist>
  <para>For hardware and system requirements and hardware configuration
  information, see 
  <xref linkend="settinguplustresystem" />.</para>
  <section xml:id="dbdoclet.50438261_99193">
    <title>
    <indexterm>
      <primary>installing</primary>
      <secondary>preparation</secondary>
    </indexterm>Preparing to Install the Lustre Software</title>
    <para>You can install the Lustre software from downloaded packages (RPMs)
    or directly from the source code. This chapter describes how to install the
    Lustre RPM packages. For information about installing from source code, see
    
    <xref linkend="installinglustrefromsourcecode" />.</para>
    <para>The Lustre RPM packages have been tested on the Linux distributions
    listed in the table below.</para>
    <para>
      <table frame="all" xml:id="LustreTestMatrixTable">
        <title>Lustre Test Matrix</title>
        <tgroup cols="3">
          <colspec colname="c1" colnum="1" colwidth="1*" />
          <colspec colname="c2" colnum="2" colwidth="1.1*" />
          <colspec colname="c3" colnum="3" colwidth="1.46*" />
          <thead>
            <row>
              <entry>Lustre Release</entry>
              <entry>Servers Tested
              <superscript>1</superscript></entry>
              <entry>Clients Tested</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>
                <para>2.0</para>
              </entry>
              <entry>
                <para>RHEL 5, CentOS 5</para>
              </entry>
              <entry>
                <para>RHEL 5, CentOS 5, SLES 11 SP0</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>2.1.x</para>
              </entry>
              <entry>
                <para>RHEL 5, CentOS 5, RHEL 6, CentOS 6</para>
              </entry>
              <entry>
                <para>RHEL 5, CentOS 5, RHEL 6, CentOS 6, SLES 11 SP1</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>2.2</para>
              </entry>
              <entry>
                <para>RHEL 6, CentOS 6</para>
              </entry>
              <entry>
                <para>RHEL 5, CentOS 5, RHEL 6, CentOS 6, SLES 11 SP1</para>
              </entry>
            </row>
            <row>
              <entry>
                <para>2.3</para>
              </entry>
              <entry>
                <para>RHEL 6.3, CentOS 6.3</para>
              </entry>
              <entry>
                <para>RHEL 6.3, CentOS 6.3, RHEL 5.8, CentOS 5.8, SLES 11
                SP1</para>
              </entry>
            </row>
            <row>
              <entry>2.4.x</entry>
              <entry>
                <para>RHEL 6.4, CentOS 6.4</para>
              </entry>
              <entry>
                <para>RHEL 6.4, CentOS 6.4, SLES 11 SP2, FC18</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
    </para>
    <para>
    <superscript>1</superscript>Red Hat Enterprise Edition (RHEL), CentOS
    Enterprise Linux Distribution (CentOS), SUSE Linux Enterprise Server
    (SLES), Fedora
    <superscript>*</superscript>F18 Linux kernel (FC18).</para>
    <section xml:id="section_rqs_tjw_3k">
      <title>Software Requirements</title>
      <para>To install the Lustre software from RPMs, the following are
      required:
      <itemizedlist>
        <listitem>
          <para>
          <emphasis role="bold">
            <emphasis role="italic">Lustre server packages</emphasis>
          </emphasis>. The required packages for Lustre servers are listed in
          the table below, where 
          <replaceable>ver</replaceable>refers to the Linux kernel distribution
          (e.g., 2.6.32-358.6.2.el6) and 
          <replaceable>arch</replaceable>refers to the processor architecture
          (e.g., x86_64). These packages are available in the 
          <link xl:href="https://wiki.hpdd.intel.com/display/PUB/Lustre+Releases">
          Lustre Releases</link>repository.</para>
          <para>
            <table frame="all" xml:id="table_cnh_5m3_gk">
              <title>Packages Installed on Lustre Servers</title>
              <tgroup cols="2">
                <colspec colname="c1" colnum="1" colwidth="1.18*" />
                <colspec colname="c2" colnum="2" colwidth="1*" />
                <thead>
                  <row>
                    <entry>Package Name</entry>
                    <entry>Description</entry>
                  </row>
                </thead>
                <tbody>
                  <row>
                    <entry>
                      <code>kernel-</code>
                      <replaceable>ver</replaceable>
                      <code>_lustre.</code>
                      <replaceable>arch</replaceable>
                    </entry>
                    <entry>Linux kernel with Lustre software patches (often
                    referred to as "patched kernel")</entry>
                  </row>
                  <row>
                    <entry>
                      <code>lustre-</code>
                      <replaceable>ver</replaceable>
                      <code>_lustre.</code>
                      <replaceable>arch</replaceable>
                    </entry>
                    <entry>Lustre software command line tools</entry>
                  </row>
                  <row>
                    <entry>
                      <code>lustre-modules-</code>
                      <replaceable>ver</replaceable>
                      <code>_lustre.</code>
                      <replaceable>arch</replaceable>
                    </entry>
                    <entry>Lustre-patched kernel modules</entry>
                  </row>
                  <row>
                    <entry>
                      <code>lustre-osd-ldiskfs-</code>
                      <replaceable>ver</replaceable>
                      <code>_lustre.</code>
                      <replaceable>arch</replaceable>
                    </entry>
                    <entry>Lustre back-end file system tools</entry>
                  </row>
                  <row>
                    <entry>
                      <code>lustre-zfs-ldiskfs-</code>
                      <replaceable>ver</replaceable>
                      <code>_lustre.</code>
                      <replaceable>arch</replaceable>
                    </entry>
                    <entry>Lustre back-end file system tools for ZFS. This is 
                    an alternative to 
                    <literal>lustre-osd-ldiskfs</literal></entry>
                  </row>
                  <row>
                    <entry>
                      <code>e2fsprogs</code>
                    </entry>
                    <entry>Utility to maintain Lustre back-end file
                    system</entry>
                  </row>
                  <row>
                    <entry>
                      <code>lustre-tests-</code>
                      <replaceable>ver</replaceable>
                      <code>_lustre.</code>
                      <replaceable>arch</replaceable>
                    </entry>
                    <entry>Lustre I/O Kit benchmarking tools
                    <emphasis role="italic">(Included in Lustre software as of
                    release 2.2)</emphasis></entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </para>
        </listitem>
        <listitem>
          <para>
          <emphasis role="bold">
            <emphasis role="italic">Lustre client packages</emphasis>
          </emphasis>. The required packages for Lustre clients are listed in
          the table below, where 
          <replaceable>ver</replaceable>refers to the Linux distribution (e.g.,
          2.6.18-348.1.1.el5). These packages are available in the 
          <link xl:href="https://wiki.hpdd.intel.com/display/PUB/Lustre+Releases">
          Lustre Releases</link>repository.</para>
          <para>
            <table frame="all" xml:id="table_j3r_ym3_gk">
              <title>Packages Installed on Lustre Clients</title>
              <tgroup cols="2">
                <colspec colname="c1" colnum="1" colwidth="1*" />
                <colspec colname="c2" colnum="2" colwidth="1.02*" />
                <thead>
                  <row>
                    <entry>Package Name</entry>
                    <entry>Description</entry>
                  </row>
                </thead>
                <tbody>
                  <row>
                    <entry>
                      <code>lustre-client-modules-</code>
                      <replaceable>ver</replaceable>
                    </entry>
                    <entry>Patchless kernel modules for client</entry>
                  </row>
                  <row>
                    <entry>
                      <code>lustre-client-</code>
                      <replaceable>ver</replaceable>
                      <code>_lustre</code>
                    </entry>
                    <entry>Client command line tools</entry>
                  </row>
                  <row>
                    <entry>
                      <code>lustre-client-tests-</code>
                      <replaceable>ver</replaceable>
                    </entry>
                    <entry>Lustre I/O Kit 
                    <emphasis role="italic">(Included in Lustre software as of
                    release 2.2)</emphasis></entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </para>
          <note>
            <para>The version of the kernel running on a Lustre client must be
            the same as the version of the 
            <code>lustre-client-modules-</code>
            <replaceable>ver</replaceable>package being installed. If the
            kernel running on the client is not compatible, a kernel that is
            compatible must be installed on the client before the Lustre file
            system software is installed.</para>
          </note>
        </listitem>
        <listitem>
          <para>
          <emphasis role="bold">
            <emphasis role="italic">Lustre LNET network driver (LND)</emphasis>
          </emphasis>. The Lustre LNDs provided with the Lustre software are
          listed in the table below. For more information about Lustre LNET,
          see 
          <xref xmlns:xlink="http://www.w3.org/1999/xlink"
          linkend="understandinglustrenetworking" />.</para>
          <table frame="all" xml:id="table_bkx_dn3_gk">
            <title>Network Types Supported by Lustre LNDs</title>
            <tgroup cols="2">
              <colspec colname="c1" colnum="1" colwidth="1*" />
              <colspec colname="newCol2" colnum="2" colwidth="1.95*" />
              <thead>
                <row>
                  <entry>Supported Network Types</entry>
                  <entry>Notes</entry>
                </row>
              </thead>
              <tbody>
                <row>
                  <entry>TCP</entry>
                  <entry>Any network carrying TCP traffic, including GigE,
                  10GigE, and IPoIB</entry>
                </row>
                <row>
                  <entry>InfiniBand network</entry>
                  <entry>OpenFabrics OFED (o2ib)</entry>
                </row>
                <row>
                  <entry>gni</entry>
                  <entry>Gemini (Cray)</entry>
                </row>
                <row>
                  <entry>Seastar</entry>
                  <entry>Cray</entry>
                </row>
                <row>
                  <entry>MX</entry>
                  <entry>Myrinet network</entry>
                </row>
                <row>
                  <entry>ra</entry>
                  <entry>RapidArray
                  <superscript>*</superscript>interconnect</entry>
                </row>
                <row>
                  <entry>Elan</entry>
                  <entry>Quadrics</entry>
                </row>
              </tbody>
            </tgroup>
          </table>
        </listitem>
      </itemizedlist></para>
      <para>
        <note>
          <para>The InfiniBand and TCP Lustre LNDs are routinely tested during
          release cycles. The other LNDs are maintained by their respective
          owners</para>
        </note>
        <itemizedlist>
          <listitem>
            <para>
            <emphasis role="bold">
              <emphasis role="italic">High availability software</emphasis>
            </emphasis>. If needed, install third party high-availability
            software. For more information, see 
            <xref linkend="dbdoclet.50438188_92688" />.</para>
          </listitem>
          <listitem>
            <para>
            <emphasis role="bold">
              <emphasis role="italic">Optional packages.</emphasis>
            </emphasis>Optional packages provided in the 
            <link xl:href="https://wiki.hpdd.intel.com/display/PUB/Lustre+Releases">
            Lustre Releases</link>repository may include the following
            (depending on the operating system and platform):
            <itemizedlist>
              <listitem>
                <para>
                <code>kernel-debuginfo</code>, 
                <code>kernel-debuginfo-common</code>, 
                <code>lustre-debuginfo</code>, 
                <code>lustre-osd-ldiskfs-debuginfo</code>- Versions of required
                packages with debugging symbols and other debugging options
                enabled for use in troubleshooting.</para>
              </listitem>
              <listitem>
                <para>
                <code>kernel-devel</code>, - Portions of the kernel tree needed
                to compile third party modules, such as network drivers.</para>
              </listitem>
              <listitem>
                <para>
                <code>kernel-firmware</code>- Standard Red Hat Enterprise Linux
                distribution that has been recompiled to work with the Lustre
                kernel.</para>
              </listitem>
              <listitem>
                <para>
                <code>kernel-headers</code>- Header files installed under
                /user/include and used when compiling user-space,
                kernel-related code.</para>
              </listitem>
              <listitem>
                <para>
                <code>lustre-source</code>- Lustre software source code.</para>
              </listitem>
              <listitem>
                <para>
                <emphasis role="italic">(Recommended)</emphasis>
                <code>perf</code>, 
                <code>perf-debuginfo</code>, 
                <code>python-perf</code>, 
                <code>python-perf-debuginfo</code>- Linux performance analysis
                tools that have been compiled to match the Lustre kernel
                version.</para>
              </listitem>
            </itemizedlist></para>
          </listitem>
        </itemizedlist>
      </para>
    </section>
    <section xml:id="section_rh2_d4w_gk">
      <title>Environmental Requirements</title>
      <para>Before installing the Lustre software, make sure the following
      environmental requirements are met.
      <itemizedlist>
        <listitem>
          <para>
          <emphasis role="italic">(Required)</emphasis>
          <emphasis role="italic">
            <emphasis role="bold">Disable Security-Enhanced Linux
            <superscript>*</superscript>(SELinux) on all Lustre servers and
            clients.</emphasis>
          </emphasis>The Lustre software does not support SELinux. Therefore,
          the SELinux system extension must be disabled on all Lustre nodes.
          Also, make sure other security extensions (such as the Novell
          AppArmor
          <superscript>*</superscript>security system) and network packet
          filtering tools (such as iptables) do not interfere with the Lustre
          software.</para>
        </listitem>
        <listitem>
          <para>
          <emphasis role="italic">(Required)</emphasis>
          <emphasis role="italic">
            <emphasis role="bold">Use the same user IDs (UID) and group IDs
            (GID) on all clients.</emphasis>
          </emphasis>If use of supplemental groups is required, see 
          <xref linkend="dbdoclet.50438291_32926" />for information about
          supplementary user and group cache upcall (
          <code>identity_upcall</code>).</para>
        </listitem>
        <listitem>
          <para>
          <emphasis role="italic">(Recommended)</emphasis>
          <emphasis role="italic">
            <emphasis role="bold">Provide remote shell access to
            clients.</emphasis>
          </emphasis>It is recommended that all cluster nodes have remote shell
          client access to facilitate the use of Lustre configuration and
          monitoring scripts. Parallel Distributed SHell (pdsh) is preferable,
          although Secure SHell (SSH) is acceptable.</para>
        </listitem>
        <listitem>
          <para>
          <emphasis role="italic">(Recommended)</emphasis>
          <emphasis role="italic">
            <emphasis role="bold">Ensure client clocks are
            synchronized.</emphasis>
          </emphasis>The Lustre file system uses client clocks for timestamps.
          If clocks are out of sync between clients, files will appear with
          different time stamps when accessed by different clients. Drifting
          clocks can also cause problems by, for example, making it difficult
          to debug multi-node issues or correlate logs, which depend on
          timestamps. We recommend that you use Network Time Protocol (NTP) to
          keep client and server clocks in sync with each other. For more
          information about NTP, see: 
          <link xl:href="http://www.ntp.org/">http://www.ntp.org</link>.</para>
        </listitem>
      </itemizedlist></para>
    </section>
  </section>
  <section xml:id="dbdoclet.50438261_41900">
    <title>Lustre Software Installation Procedure</title>
    <caution>
      <para>Before installing the Lustre software, back up ALL data. The Lustre
      software contains kernel modifications that interact with storage devices
      and may introduce security issues and data loss if not installed,
      configured, or administered properly.</para>
    </caution>
    <para>To install the Lustre software from RPMs, complete the steps
    below.</para>
    <orderedlist>
      <listitem>
        <para>Verify that all Lustre installation requirements have been
        met.</para>
        <itemizedlist>
          <listitem>
            <para>For hardware requirements, see 
            <xref linkend="settinguplustresystem" />.</para>
          </listitem>
          <listitem>
            <para>For software and environmental requirements, see the section 
            <xref xmlns:xlink="http://www.w3.org/1999/xlink"
            linkend="dbdoclet.50438261_99193" />above.</para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>Download the 
        <literal>e2fsprogs</literal> RPMs for your platform from the 
        <link xl:href="https://wiki.hpdd.intel.com/display/PUB/Lustre+Releases">
        Lustre Releases</link>repository.</para>
      </listitem>
      <listitem>
        <para>Download the Lustre server RPMs for your platform from the 
        <link xl:href="https://wiki.hpdd.intel.com/display/PUB/Lustre+Releases">
        Lustre Releases</link>repository. See 
        <xref xmlns:xlink="http://www.w3.org/1999/xlink"
        linkend="table_cnh_5m3_gk" />for a list of required packages.</para>
      </listitem>
      <listitem xml:id="dbdoclet.50438261_88296">
        <para>Install the Lustre server and 
        <literal>e2fsprogs</literal> packages on all Lustre servers (MGS, MDSs,
        and OSSs).
        <orderedlist numeration="loweralpha">
          <listitem>
            <para>Log onto a Lustre server as the 
            <literal>root</literal> user</para>
          </listitem>
          <listitem>
            <para>Use the 
            <literal>yum</literal> command to install the packages:</para>
            <para>
              <screen>
# yum --nogpgcheck install pkg1.rpm pkg2.rpm ...
</screen>
            </para>
          </listitem>
          <listitem>
            <para>Verify the packages are installed correctly:</para>
            <para>
              <screen>
rpm -qa|egrep "lustre|wc"|sort
</screen>
            </para>
          </listitem>
          <listitem>
            <para>Reboot the server.</para>
          </listitem>
          <listitem>
            <para>Repeat these steps on each Lustre server.</para>
          </listitem>
        </orderedlist></para>
      </listitem>
      <listitem>
        <para>Download the Lustre client RPMs for your platform from the 
        <link xl:href="https://wiki.hpdd.intel.com/display/PUB/Lustre+Releases">
        Lustre Releases</link>repository. See 
        <xref xmlns:xlink="http://www.w3.org/1999/xlink"
        linkend="table_j3r_ym3_gk" />for a list of required packages.</para>
      </listitem>
      <listitem>
        <para>Install the Lustre client packages on all Lustre clients.
        <note>
          <para>The version of the kernel running on a Lustre client must be
          the same as the version of the 
          <literal>lustre-client-modules-</literal>
          <replaceable>ver</replaceable>package being installed. If not, a
          compatible kernel must be installed on the client before the Lustre
          client packages are installed.</para>
        </note></para>
        <orderedlist numeration="loweralpha">
          <listitem>
            <para>Log onto a Lustre client as the root user.</para>
          </listitem>
          <listitem>
            <para>Use the 
            <literal>yum</literal> command to install the packages:</para>
            <para>
              <screen>
# yum --nogpgcheck install pkg1.rpm pkg2.rpm ...
</screen>
            </para>
          </listitem>
          <listitem>
            <para>Verify the packages were installed correctly:</para>
            <para>
              <screen>
# rpm -qa|egrep "lustre|kernel"|sort
</screen>
            </para>
          </listitem>
          <listitem>
            <para>Reboot the client.</para>
          </listitem>
          <listitem>
            <para>Repeat these steps on each Lustre client.</para>
          </listitem>
        </orderedlist>
      </listitem>
    </orderedlist>
    <para>To configure LNET, go to 
    <xref linkend="configuringlnet" />. If default settings will be used for
    LNET, go to 
    <xref linkend="configuringlustre" />.</para>
  </section>
</chapter>
